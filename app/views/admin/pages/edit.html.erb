<%
  self.page_title = "Editing â€œ" + @page.name.to_s + "â€"
  self.page_description = "Editing " + [@page.ancestors.reverse,@page].flatten.map{|page| link_to((page.name rescue "(Untitled)"), edit_admin_page_path(@locale, page))}.join(" &raquo; ")

  if PagesCore.config.localizations?
    self.page_description_links = "In " + safe_join(
      PagesCore.config.locales.map do |l, name|
        link_to_unless((l == @locale.to_sym), name, edit_admin_page_path(l, @page.localize(l)))
      end,
      link_separator)
  end
%>

<% content_for :main_wrapper do %>
  <%= form_for(@page,
               url: admin_page_url(@locale, @page),
               builder: PagesCore::Admin::FormBuilder,
               html: {
                 class: "edit-page main-wrapper",
                 method: :put,
                 data: {
                   controller: "edit-page",
                   "edit-page-target": "form",
                   "preview-url": preview_page_url(@page.locale, @page)
                 }
               }) do |f| %>

    <% content_for :main do %>
      <div class="content">
        <%= render(partial: "form", locals: { f: f }) %>

        <div class="buttons">
          <button type="button"
                  id="previewButton"
                  data-action="click->edit-page#preview"
                  data-url="<%= preview_page_url(@page.locale, @page) %>">
            Preview
          </button>
          <button type="submit">
            Save
          </button>
        </div>
      </div>
    <% end %>

    <main data-controller="main">
      <%= render(partial: "layouts/admin/page_header") %>
      <%= yield :main %>
    </main>

    <aside class="sidebar" id="page-form-sidebar">
      <%= render partial: 'edit_options', locals: { f: f } %>
    </aside>
  <% end %>
<% end %>
