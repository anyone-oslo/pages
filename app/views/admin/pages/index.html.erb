<%
	page_title "Pages"
	page_description "Viewing pages"
	if PagesCore.config( :localizations )
		page_description_links "In " + @available_languages.map{ |l| link_to_unless_current( Language.name_for_code( l ), hash_for_admin_pages_path( :language => l ) ) }.join( link_separator ) 
	end
%>

<% sidebar do %>
	<h2>Adding pages</h2>
	<p>
		Click here to create a new page at the root level.
		<%= button_to "New page", new_admin_page_path( :language => @language ), :method => :get %>
	</p>
	<h2>Categories</h2>
	<% if @categories && @categories.length > 0 %>
		<ul>
			<% @categories.each do |category| %>
				<li><%= category.name %> (<%= link_to "Delete", admin_category_path(category), :method => :delete, :class => :delete, :confirm => "Are you sure? There is no undo." %>)</li>
			<% end %>
		</ul>
	<% else %>
		<p>No categories added yet.</p>
	<% end %>
		<div id="new-category">
			<% form_for([:admin, Category.new]) do |f| %>
				<p>
					<label><strong>New category</strong></label>
					<%= f.text_field :name %>
					<%= submit_tag "Save" %>
				</p>
			<% end %>
		</div>
		<div id="new-category-button">
			<p><%= button_to_function "Add a new category", 'toggleNewCategory();' %></p>
		</div>
<% end %>

<div class="content">
	<% if @root_pages.length < 1 -%>
		<p>No pages found</p>
	<% else -%>
		<ul class="pagelist">
			<% @root_pages.each do |page| -%>
				<%= render :partial => "pagelisting", :locals => { :page => page } %>
			<% end -%>
		</ul>
	<% end -%>
</div>