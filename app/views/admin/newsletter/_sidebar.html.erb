<h2>Compose</h2>
<p>
	<%= link_to "Compose newsletter", { :action => :compose } %>
</p>

<h2>Subscribers</h2>
<p>
	<%= link_to "View subscribers", { :action => :index } %><br />
	<%= link_to_function "Add subscriber", 'show_add_subscriber_form();' %><br />
	<%= link_to "Import subscribers", { :action => :import } %><br />
</p>

<div id="add-subscriber">
	<h2>New subscriber</h2>
	<% form_for 'subscriber', ( @new_subscriber ||= MailSubscriber.new ), :url => { :action => :create } do |f| %>
		<%= labelled_field f.text_field( :email ), 'Email', :errors => @new_subscriber.errors[:email] %>
		<%= labelled_field f.select( :group, MailSubscriber.groups ), 'Select existing group', :errors => @new_subscriber.errors[:group] %>
		<%= labelled_field text_field_tag( :new_group ), '..or create a new group' %>
		<%= %>
		<p><%= submit_tag "Create" %></p>
	<% end %>
</div>

<script type="text/javascript">
	<% unless @new_subscriber && @new_subscriber.errors.length > 0 %>
		Element.hide( 'add-subscriber' );
	<% end %>
	function show_add_subscriber_form() {
		Element.show( 'add-subscriber' );
	}
	
</script>

<h2>Export to CSV</h2>
<ul>
	<% MailSubscriber.groups.each do |group| %>
		<li><%= link_to "Group: #{group}", { :action => :csv_export, :group => group } %></li>
	<% end %>
	<li><%= link_to "All subscribers", { :action => :csv_export } %></li>
</ul>

